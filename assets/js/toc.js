(()=>{var e,n=document,r=window,a=2,c={isOpen:!1,isVisible:!1,articleTop:0,articleBottom:0,lastScrollTop:0,isScrollingDown:!1},d={sidebar:null,mobileTrigger:null,mobileOverlay:null,mobileDrawer:null,mobileList:null};function m(e,t){var i=n.body;return i&&i.getAttribute("data-i18n-"+e)||t}function l(){var e,t;d.mobileList&&(e=n.querySelector(".toc-sidebar .toc-link.is-active"),t=e?e.getAttribute("href"):null,d.mobileList.querySelectorAll(".toc-mobile-link").forEach(function(e){t&&e.getAttribute("href")===t?e.classList.add("is-active"):e.classList.remove("is-active")}))}function b(){var e=n.querySelector(".post-content");e&&(e=e.getBoundingClientRect(),c.articleTop=e.top+r.pageYOffset,c.articleBottom=e.bottom+r.pageYOffset)}function g(){var e,t,i,o;d.sidebar&&(e=r.pageYOffset||n.documentElement.scrollTop,o=r.innerHeight,i=0<(t=e-c.lastScrollTop),5<Math.abs(t)&&i!==c.isScrollingDown&&(c.isScrollingDown=i,d.mobileTrigger)&&(!((r.pageYOffset||n.documentElement.scrollTop)<200)&&c.isScrollingDown?d.mobileTrigger.classList.add("is-hidden-scroll"):d.mobileTrigger.classList.remove("is-hidden-scroll")),c.lastScrollTop=e,(t=n.querySelector(".post-content"))&&(i=t.getBoundingClientRect(),c.articleTop=i.top+e,c.articleBottom=i.bottom+e),t=c.articleTop-100,i=c.articleBottom-o+100,(o=t<=e&&e<=i)!==c.isVisible&&((c.isVisible=o)?d.sidebar.classList.add("is-visible"):d.sidebar.classList.remove("is-visible")),l())}function u(){l(),c.isOpen=!0,d.mobileTrigger.classList.add("is-hidden"),d.mobileOverlay.classList.add("is-open"),d.mobileDrawer.classList.add("is-open"),setTimeout(function(){var i,o;i=d.mobileDrawer.querySelector(".toc-mobile-content"),o=d.mobileList.querySelector(".toc-mobile-link.is-active"),i&&o&&requestAnimationFrame(function(){var e=i.getBoundingClientRect(),t=o.getBoundingClientRect(),t=t.top-e.top+i.scrollTop-e.height/2+t.height/2,e=i.scrollHeight-e.height;i.scrollTo({top:Math.max(0,Math.min(t,e)),behavior:"auto"})})},250)}function p(){c.isOpen=!1,d.mobileTrigger.classList.remove("is-hidden"),d.mobileOverlay.classList.remove("is-open"),d.mobileDrawer.classList.remove("is-open")}function h(){var e,t,i,o,l,s;d.mobileTrigger&&(e=d.mobileTrigger.querySelector(".toc-progress-ring__progress"))&&(s=r.pageYOffset||n.documentElement.scrollTop,t=r.innerHeight,i=c.articleTop,(l=0)<(o=c.articleBottom-i)&&(l=Math.max(0,Math.min((s+t/2-i)/o,1))),s=2*Math.PI*20,e.style.strokeDashoffset=s*(1-l))}e=function(){var e,t,i,o,l,s=n.querySelector(".post-content");!s||s.classList.contains("no-toc")||(s=s.querySelectorAll("h2, h3, h4"),Array.prototype.filter.call(s,function(e){return!e.closest(".kg-poem-card")}).length<a)||(e=s={tocLabel:m("toc-label","Table of Contents"),onThisPage:m("on-this-page","On this page"),openToc:m("open-toc","Open table of contents"),closeToc:m("close-toc","Close table of contents")},(i=n.createElement("aside")).className="toc-sidebar",i.setAttribute("aria-label",e.tocLabel),(t=n.createElement("div")).className="toc-container",(l=n.createElement("div")).className="toc-header",(o=n.createElement("h3")).className="toc-title",o.textContent=e.onThisPage,l.appendChild(o),(e=n.createElement("nav")).className="toc-list",t.appendChild(l),t.appendChild(e),i.appendChild(t),n.body.appendChild(i),d.sidebar=i,o=s,(l=n.createElement("button")).className="toc-mobile-trigger",l.setAttribute("aria-label",o.openToc),e=2*Math.PI*20,l.innerHTML='<svg class="toc-progress-ring" viewBox="0 0 44 44"><circle class="toc-progress-ring__bg" cx="22" cy="22" r="20"></circle><circle class="toc-progress-ring__progress" cx="22" cy="22" r="20" stroke-dasharray="'+e+'" stroke-dashoffset="'+e+'"></circle></svg><svg class="toc-trigger-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',(e=n.createElement("div")).className="toc-mobile-overlay",(t=n.createElement("div")).className="toc-mobile-drawer",t.setAttribute("role","dialog"),t.setAttribute("aria-label",o.tocLabel),(i=n.createElement("div")).className="toc-mobile-header",(s=n.createElement("h3")).className="toc-mobile-title",s.textContent=o.onThisPage,i.appendChild(s),(s=n.createElement("button")).className="toc-mobile-close",s.setAttribute("aria-label",o.closeToc),s.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',i.appendChild(s),(o=n.createElement("div")).className="toc-mobile-content",(s=n.createElement("nav")).className="toc-mobile-list",o.appendChild(s),t.appendChild(i),t.appendChild(o),n.body.appendChild(l),n.body.appendChild(e),n.body.appendChild(t),d.mobileTrigger=l,d.mobileOverlay=e,d.mobileDrawer=t,d.mobileList=s,"undefined"!=typeof tocbot&&(tocbot.init({tocSelector:".toc-list",contentSelector:".post-content",headingSelector:"h2, h3, h4",ignoreSelector:".js-toc-ignore, .kg-poem-card h2, .kg-poem-card h3, .kg-poem-card h4, .gh-post-upgrade-cta h2",hasInnerContainers:!0,linkClass:"toc-link",activeLinkClass:"is-active",listClass:"toc-list",listItemClass:"toc-item",activeListItemClass:"is-active-li",collapseDepth:6,scrollSmooth:!0,scrollSmoothOffset:-100,headingsOffset:100,throttleTimeout:50,orderedList:!1,onClick:function(e){c.isOpen&&p()}}),setTimeout(function(){var e=n.querySelector(".toc-sidebar .toc-list");if(e&&d.mobileList){var t=e.cloneNode(!0);for(t.className="toc-mobile-list",t.querySelectorAll(".toc-item").forEach(function(e){e.className=e.className.replace("toc-item","toc-mobile-item")}),t.querySelectorAll(".toc-link").forEach(function(i){i.className=i.className.replace("toc-link","toc-mobile-link"),i.addEventListener("click",function(e){e.preventDefault();var e=i.getAttribute("href").substring(1),t=n.getElementById(e);t&&(p(),setTimeout(function(){var e=t.getBoundingClientRect().top+r.pageYOffset-100;r.scrollTo({top:e,behavior:"smooth"})},300))})}),t.querySelectorAll(".toc-list").forEach(function(e){e.className=e.className.replace("toc-list","toc-mobile-list")}),d.mobileList.innerHTML="";t.firstChild;)d.mobileList.appendChild(t.firstChild)}},100),i=n.querySelector(".toc-sidebar .toc-list"))&&d.sidebar&&new MutationObserver(function(e){e.forEach(function(e){var t,i,o;"attributes"===e.type&&"class"===e.attributeName&&(e=e.target).classList.contains("is-active")&&e.classList.contains("toc-link")&&(e=e,d.sidebar)&&e&&(t=d.sidebar,i=t.getBoundingClientRect(),e=e.getBoundingClientRect(),o=e.top-i.top+t.scrollTop,e=e.height,i=i.height,o=o-i/2+e/2,e=t.scrollHeight-i,o=Math.max(0,Math.min(o,e)),t.scrollTo({top:o,behavior:"smooth"}))})}).observe(i,{attributes:!0,subtree:!0,attributeFilter:["class"]}),o=((i,o)=>{var l=0,s=null;return function(){var e=Date.now(),t=o-(e-l);t<=0?(s&&(clearTimeout(s),s=null),l=e,i()):s=s||setTimeout(function(){l=Date.now(),s=null,i()},t)}})(function(){g(),h()},100),l={passive:!0},"webkitRequestAnimationFrame"in r&&(l.passive=!0),r.addEventListener("scroll",o,l),r.addEventListener("resize",o,l),r.addEventListener("orientationchange",function(){setTimeout(function(){b(),g(),h()},100)},l),h(),d.mobileTrigger.addEventListener("click",u),d.mobileOverlay.addEventListener("click",p),(o=d.mobileDrawer.querySelector(".toc-mobile-close"))&&o.addEventListener("click",p),n.addEventListener("keydown",function(e){"Escape"===e.key&&c.isOpen&&p()}),b(),g(),n.body.classList.add("has-toc"),setTimeout(function(){d.mobileTrigger&&d.mobileTrigger.classList.add("is-visible")},500))},"loading"===n.readyState?n.addEventListener("DOMContentLoaded",e):e()})();