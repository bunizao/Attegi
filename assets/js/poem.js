(()=>{function e(){document.querySelectorAll(".post-content blockquote").forEach(e=>{var t;e.textContent.trim().includes("[!poem]")&&(t=(e=>{let t=[],l=e.querySelectorAll("p");if(0<l.length?l.forEach(e=>{e=e.textContent.trim();e&&t.push(e)}):((e=e.cloneNode(!0)).querySelectorAll("br").forEach(e=>e.replaceWith("\n")),(e.textContent||"").split(/\r?\n/).forEach(e=>{e=e.trim();e&&t.push(e)})),0===t.length)return null;let n=-1,a="";for(let e=0;e<t.length;e++)if(t[e].includes("[!poem]")){n=e;var r=t[e].match(/\[!poem\](.*)$/);r&&(a=r[1].trim());break}if(-1===n)return null;let c=t.slice(n+1),d="",i=[];for(let e=c.length-1;0<=e;e--){var o=c[e];if(o.startsWith("—")||o.startsWith("--")||o.startsWith("- ")){d=o.replace(/^--/,"—").replace(/^- /,"— "),i=c.slice(0,e);break}}!d&&0<c.length&&(i=c);let p=!1,s=!1;return(a.includes("[center]")||a.includes("[居中]"))&&(p=!0),(a.includes("[plain]")||a.includes("[非斜体]"))&&(s=!0),{title:e=a.replace(/\[center\]/gi,"").replace(/\[居中\]/g,"").replace(/\[plain\]/gi,"").replace(/\[非斜体\]/g,"").trim(),verses:i.filter(e=>0<e.length),author:d,centered:p,plain:s}})(e))&&(t=(e=>{var t,l,n=document.createElement("div");if(n.className="kg-poem-card",e.centered&&n.classList.add("kg-poem-centered"),e.plain&&n.classList.add("kg-poem-plain"),e.title&&((t=document.createElement("div")).className="kg-poem-header",(l=document.createElement("h4")).className="kg-poem-title",l.textContent=e.title,t.appendChild(l),n.appendChild(t),(l=document.createElement("div")).className="kg-poem-divider",n.appendChild(l)),0<e.verses.length){let l=document.createElement("div");l.className="kg-poem-content",e.verses.forEach(e=>{var t=document.createElement("p");t.className="kg-poem-line",t.textContent=e,l.appendChild(t)}),n.appendChild(l)}return e.author&&((t=document.createElement("div")).className="kg-poem-divider",n.appendChild(t),(l=document.createElement("p")).className="kg-poem-author",l.textContent=e.author,n.appendChild(l)),n})(t),e.parentNode.replaceChild(t,e))})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()})();